<svg width="800" height="400" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333" />
    </marker>
    <style>
      .box { fill: #fff; stroke: #333; stroke-width: 2; }
      .text { font-family: Arial, sans-serif; text-anchor: middle; font-size: 14px; }
      .label { font-weight: bold; font-size: 16px; }
      .sublabel { font-size: 12px; fill: #666; }
    </style>
  </defs>

  <!-- Section 1: Input -->
  <rect x="50" y="50" width="150" height="300" class="box" fill="#E6F0FF" />
  <text x="125" y="80" class="text label">Cell Tokens</text>
  <text x="125" y="100" class="text sublabel">(N x d)</text>
  
  <rect x="70" y="130" width="110" height="40" rx="5" fill="#3366CC" opacity="0.8" />
  <text x="125" y="155" class="text" fill="#fff">Transcriptome</text>

  <rect x="70" y="180" width="110" height="40" rx="5" fill="#3366CC" opacity="0.6" />
  <text x="125" y="205" class="text" fill="#fff">Lineage ID</text>

  <rect x="70" y="230" width="110" height="40" rx="5" fill="#3366CC" opacity="0.4" />
  <text x="125" y="255" class="text" fill="#fff">Time</text>

  <!-- Arrow -->
  <line x1="200" y1="200" x2="250" y2="200" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />

  <!-- Section 2: Encoder -->
  <rect x="250" y="50" width="200" height="300" class="box" fill="#F0E6FF" />
  <text x="350" y="80" class="text label">Pairwise Tx</text>
  <text x="350" y="100" class="text sublabel">Axial Attention</text>

  <rect x="275" y="130" width="150" height="60" rx="5" fill="#800080" opacity="0.7" />
  <text x="350" y="165" class="text" fill="#fff">Row Attention</text>

  <rect x="275" y="210" width="150" height="60" rx="5" fill="#800080" opacity="0.7" />
  <text x="350" y="245" class="text" fill="#fff">Col Attention</text>

  <!-- Arrow -->
  <line x1="450" y1="200" x2="500" y2="200" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />

  <!-- Section 3: Flow Head -->
  <rect x="500" y="50" width="150" height="300" class="box" fill="#FFE6E6" />
  <text x="575" y="80" class="text label">Flow Head</text>
  <text x="575" y="100" class="text sublabel">Predict Velocity v</text>

  <circle cx="575" cy="180" r="30" fill="#fff" stroke="#D00" stroke-width="2" />
  <text x="575" y="185" class="text" font-weight="bold">v</text>
  <text x="575" y="250" class="text sublabel">Conditioned on t</text>

  <!-- Arrow -->
  <line x1="650" y1="200" x2="700" y2="200" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />

  <!-- Section 4: Output -->
  <rect x="700" y="125" width="150" height="150" class="box" fill="#fff" />
  <!-- Grid pattern -->
  <rect x="710" y="135" width="130" height="130" fill="#CC6600" opacity="0.2" />
  <line x1="710" y1="135" x2="840" y2="265" stroke="#CC6600" stroke-width="2" />
  
  <text x="775" y="300" class="text label">Adjacency</text>
  <text x="775" y="320" class="text sublabel">(N x N)</text>

</svg>